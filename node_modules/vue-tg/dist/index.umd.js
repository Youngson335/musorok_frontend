(function(r,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(r=typeof globalThis<"u"?globalThis:r||self,t(r["vue-tg"]={},r.Vue))})(this,function(r,t){"use strict";const A=t.defineComponent({__name:"Alert",props:{message:{type:String,required:!0}},emits:["close"],setup(e,{emit:a}){const n=e,o=a,{showAlert:i}=f();return t.onMounted(()=>i(n.message,()=>o("close"))),(s,c)=>null}}),h=t.defineComponent({__name:"BackButton",props:{visible:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:a}){const n=e,o=a,{showBackButton:i,onBackButtonClicked:s,hideBackButton:c}=E();return t.watch(()=>n.visible,u=>{u?i():c()}),s(()=>o("click")),t.onMounted(()=>n.visible&&i()),t.onUnmounted(()=>c()),(u,d)=>null}}),W=t.defineComponent({__name:"BiometricManager",emits:["init"],setup(e,{emit:a}){const n=a,{initBiometric:o}=L();return t.onMounted(()=>o(()=>n("init"))),(i,s)=>null}}),T=t.defineComponent({__name:"ClosingConfirmation",setup(e){const{enableClosingConfirmation:a,disableClosingConfirmation:n}=v();return t.onMounted(()=>a()),t.onUnmounted(()=>n()),(o,i)=>null}}),C=t.defineComponent({__name:"Confirm",props:{message:{type:String,required:!0}},emits:["close"],setup(e,{emit:a}){const n=e,o=a,{showConfirm:i}=f();return t.onMounted(()=>i(n.message,s=>o("close",s))),(s,c)=>null}}),y=t.defineComponent({__name:"ExpandedViewport",props:{force:{type:Boolean,default:!1}},setup(e){const a=e,{onViewportChanged:n,expand:o}=ye();return n(({isStateStable:i})=>{a.force&&i&&o()}),t.onMounted(()=>o()),(i,s)=>null}}),S=t.defineComponent({__name:"MainButton",props:{text:{type:String},color:{type:String},textColor:{type:String},visible:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},progress:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:a}){const n=e,o=a,{setMainButtonParams:i,onMainButtonClicked:s,hideMainButton:c,showMainButtonProgress:u,hideMainButtonProgress:d}=re();return t.watch(()=>n.text,l=>{i({text:l})}),t.watch(()=>n.color,l=>{i({color:l})}),t.watch(()=>n.textColor,l=>{i({text_color:l})}),t.watch(()=>n.visible,l=>{i({is_visible:l})}),t.watch(()=>n.disabled,l=>{i({is_active:!l})}),t.watch(()=>n.progress,l=>{l?u():d()}),s(()=>o("click")),t.onMounted(()=>{n.progress?u():d(),i({text:n.text,text_color:n.textColor,color:n.color,is_active:!n.disabled,is_visible:n.visible})}),t.onUnmounted(()=>{d(),c()}),(l,kt)=>null}}),k=t.defineComponent({__name:"Popup",props:{title:{type:String},message:{type:String,required:!0},buttons:{type:Array}},emits:["close"],setup(e,{emit:a}){const n=e,o=a,{showPopup:i}=f();return t.onMounted(()=>i({title:n.title,message:n.message,buttons:n.buttons},s=>o("close",s))),(s,c)=>null}}),{initData:xe,initDataUnsafe:qe,version:De,platform:Ee,isVersionAtLeast:Re,sendData:$e,close:Ie}=Telegram.WebApp,M=t.ref(!1),Ue=(...e)=>{Telegram.WebApp.ready(...e),M.value=!0},w=e=>Telegram.WebApp.platform===e,P=w("unknown"),He=!P&&Telegram.WebApp.initData==="";function p(){return{initData:xe,initDataUnsafe:qe,version:De,platform:Ee,isVersionAtLeast:Re,onEvent:(a,n,o={manual:!1})=>{const{manual:i}=o,s=()=>{Telegram.WebApp.onEvent(a,n)},c=()=>{Telegram.WebApp.offEvent(a,n)};return i?s():(t.onMounted(s),t.onUnmounted(c)),{off:c}},sendData:$e,ready:Ue,close:Ie,isReady:t.readonly(M),isPlatform:w,isPlatformUnknown:P,canSendData:He}}const _=t.ref(Telegram.WebApp.BackButton.isVisible);function x(){_.value=Telegram.WebApp.BackButton.isVisible}function q(...e){Telegram.WebApp.BackButton.show(...e),x()}function D(...e){Telegram.WebApp.BackButton.hide(...e),x()}function E(){const{onEvent:e}=p(),a=(n,o)=>e("backButtonClicked",n,o);return{isBackButtonVisible:t.computed({get(){return _.value},set(n){n?q():D()}}),onBackButtonClicked:a,showBackButton:q,hideBackButton:D}}const{init:Qe,requestAccess:Ve,authenticate:Le,updateBiometricToken:je,openSettings:ze}=Telegram.WebApp.BiometricManager,R=t.ref(Telegram.WebApp.BiometricManager.isInited),$=t.ref(Telegram.WebApp.BiometricManager.isBiometricAvailable),I=t.ref(Telegram.WebApp.BiometricManager.biometricType),U=t.ref(Telegram.WebApp.BiometricManager.isAccessRequested),H=t.ref(Telegram.WebApp.BiometricManager.isAccessGranted),Q=t.ref(Telegram.WebApp.BiometricManager.isAccessGranted),V=t.ref(Telegram.WebApp.BiometricManager.deviceId);function Oe(){R.value=Telegram.WebApp.BiometricManager.isInited,$.value=Telegram.WebApp.BiometricManager.isBiometricAvailable,I.value=Telegram.WebApp.BiometricManager.biometricType,U.value=Telegram.WebApp.BiometricManager.isAccessRequested,H.value=Telegram.WebApp.BiometricManager.isAccessGranted,V.value=Telegram.WebApp.BiometricManager.deviceId,Q.value=Telegram.WebApp.BiometricManager.isBiometricTokenSaved}function L(){const{onEvent:e}=p(),a=(i,s)=>e("biometricManagerUpdated",i,s),n=(i,s)=>e("biometricAuthRequested",i,s),o=(i,s)=>e("biometricTokenUpdated",i,s);return a(Oe),{isBiometricInited:t.readonly(R),isBiometricAvailable:t.readonly($),biometricType:t.readonly(I),isBiometricAccessRequested:t.readonly(U),isBiometricAccessGranted:t.readonly(H),isBiometricTokenSaved:t.readonly(Q),biometricDeviceId:t.readonly(V),initBiometric:Qe,requestBiometricAccess:Ve,authenticateBiometric:Le,updateBiometricToken:je,openBiometricSettings:ze,onBiometricManagerUpdated:a,onBiometricAuthRequested:n,onBiometricTokenUpdated:o}}const{readTextFromClipboard:Ne}=Telegram.WebApp;function ve(){const{onEvent:e}=p();return{readTextFromClipboard:Ne,onClipboardTextReceived:(n,o)=>e("clipboardTextReceived",n,o)}}const j=t.ref(Telegram.WebApp.isClosingConfirmationEnabled);function z(){j.value=Telegram.WebApp.isClosingConfirmationEnabled}function O(...e){Telegram.WebApp.enableClosingConfirmation(...e),z()}function N(...e){Telegram.WebApp.disableClosingConfirmation(...e),z()}function v(){return{isClosingConfirmationEnabled:t.computed({get(){return j.value},set(e){e?O():N()}}),enableClosingConfirmation:O,disableClosingConfirmation:N}}const g=Telegram.WebApp.CloudStorage;function Je(e,a){return new Promise((n,o)=>{g.setItem(e,a,(i,s)=>{i&&o(i),n(s)})})}function Ge(e){return new Promise((a,n)=>{g.getItem(e,(o,i)=>{o&&n(o),a(i)})})}function Fe(e){return new Promise((a,n)=>{g.getItems(e,(o,i)=>{o&&n(o),a(i)})})}function Ke(e){return new Promise((a,n)=>{g.removeItem(e,(o,i)=>{o&&n(o),a(i)})})}function Xe(e){return new Promise((a,n)=>{g.removeItems(e,(o,i)=>{o&&n(o),a(i)})})}function Ye(){return new Promise((e,a)=>{g.getKeys((n,o)=>{n&&a(n),e(o)})})}function Ze(){return{setStorageItem:Je,getStorageItem:Ge,getStorageItems:Fe,removeStorageItem:Ke,removeStorageItems:Xe,getStorageKeys:Ye}}const{impactOccurred:et,notificationOccurred:tt,selectionChanged:nt}=Telegram.WebApp.HapticFeedback;function ot(){return{impactOccurred:et,notificationOccurred:tt,selectionChanged:nt}}const J=t.ref(Telegram.WebApp.MainButton.text),G=t.ref(Telegram.WebApp.MainButton.color),F=t.ref(Telegram.WebApp.MainButton.textColor),K=t.ref(Telegram.WebApp.MainButton.isVisible),X=t.ref(Telegram.WebApp.MainButton.isActive),Y=t.ref(Telegram.WebApp.MainButton.isProgressVisible);function m(){J.value=Telegram.WebApp.MainButton.text,G.value=Telegram.WebApp.MainButton.color,F.value=Telegram.WebApp.MainButton.textColor,K.value=Telegram.WebApp.MainButton.isVisible,X.value=Telegram.WebApp.MainButton.isActive,Y.value=Telegram.WebApp.MainButton.isProgressVisible}function Z(...e){Telegram.WebApp.MainButton.setText(...e),m()}function ee(...e){Telegram.WebApp.MainButton.show(...e),m()}function te(...e){Telegram.WebApp.MainButton.hide(...e),m()}function ne(...e){Telegram.WebApp.MainButton.enable(...e),m()}function oe(...e){Telegram.WebApp.MainButton.disable(...e),m()}function ae(...e){Telegram.WebApp.MainButton.showProgress(...e),m()}function ie(...e){Telegram.WebApp.MainButton.hideProgress(...e),m()}function b(...e){Telegram.WebApp.MainButton.setParams(...e),m()}function re(){const{onEvent:e}=p(),a=(n,o)=>e("mainButtonClicked",n,o);return{mainButtonText:t.computed({get(){return J.value},set(n){Z(n)}}),mainButtonColor:t.computed({get(){return G.value},set(n){b({color:n})}}),mainButtonTextColor:t.computed({get(){return F.value},set(n){b({text_color:n})}}),isMainButtonVisible:t.computed({get(){return K.value},set(n){n?ee():te()}}),isMainButtonActive:t.computed({get(){return X.value},set(n){n?ne():oe()}}),isMainButtonProgressVisible:t.computed({get(){return Y.value},set(n){n?ae():ie()}}),setMainButtonText:Z,onMainButtonClicked:a,showMainButton:ee,hideMainButton:te,enableMainButton:ne,disableMainButton:oe,showMainButtonProgress:ae,hideMainButtonProgress:ie,setMainButtonParams:b}}const{switchInlineQuery:at,openLink:it,openTelegramLink:rt,openInvoice:st}=Telegram.WebApp;function ct(){const{onEvent:e}=p();return{switchInlineQuery:at,openLink:it,openTelegramLink:rt,openInvoice:st,onInvoiceClosed:(n,o)=>e("invoiceClosed",n,o)}}const{showPopup:lt,showAlert:pt,showConfirm:ut}=Telegram.WebApp;function f(){const{onEvent:e}=p();return{showPopup:lt,showAlert:pt,showConfirm:ut,onPopupClosed:(n,o)=>e("popupClosed",n,o)}}const{showScanQrPopup:mt,closeScanQrPopup:dt}=Telegram.WebApp;function se(){const{onEvent:e}=p();return{showScanQrPopup:mt,closeScanQrPopup:dt,onQrTextReceived:(n,o)=>e("qrTextReceived",n,o)}}const{requestContact:gt,requestWriteAccess:ft}=Telegram.WebApp;function bt(){const{onEvent:e}=p();return{requestContact:gt,onContactRequested:(o,i)=>e("contactRequested",o,i),requestWriteAccess:ft,onWriteAccessRequested:(o,i)=>e("writeAccessRequested",o,i)}}const{initData:Bt,initDataUnsafe:At,sendData:ht,close:Wt}=p();function Tt(e,a){const n=a.serialize??JSON.stringify,o=t.ref(""),i=c=>{o.value=c,console.error(c)},s=t.ref(!1);return{error:o,isLoading:s,execute:()=>{ht(n(e)),setTimeout(()=>i("Telegram.WebApp.sendData is only available for custom keyboards."),1e3)},executeHttp:async(c,u={})=>{const d=u.closeAfter??!0;s.value=!0;try{const l=await fetch(c,{method:"POST",body:JSON.stringify({initData:Bt,initDataUnsafe:At,data:n(e)})});return l.ok||i(`${l.status} ${l.statusText}`),l.ok&&d&&Wt(),l}catch(l){i(String(l))}finally{s.value=!1}}}}const ce=t.ref(Telegram.WebApp.SettingsButton.isVisible);function le(){ce.value=Telegram.WebApp.SettingsButton.isVisible}function pe(...e){Telegram.WebApp.SettingsButton.show(...e),le()}function ue(...e){Telegram.WebApp.SettingsButton.hide(...e),le()}function me(){const{onEvent:e}=p(),a=(n,o)=>e("settingsButtonClicked",n,o);return{isSettingsButtonVisible:t.computed({get(){return ce.value},set(n){n?pe():ue()}}),onSettingsButtonClicked:a,showSettingsButton:pe,hideSettingsButton:ue}}const de=t.ref(Telegram.WebApp.colorScheme),ge=t.ref(Telegram.WebApp.themeParams),fe=t.ref(Telegram.WebApp.headerColor),be=t.ref(Telegram.WebApp.backgroundColor);function B(){de.value=Telegram.WebApp.colorScheme,ge.value={...Telegram.WebApp.themeParams},fe.value=Telegram.WebApp.headerColor,be.value=Telegram.WebApp.backgroundColor}function Be(...e){Telegram.WebApp.setHeaderColor(...e),B()}function Ae(...e){Telegram.WebApp.setBackgroundColor(...e),B()}function Ct(){const{onEvent:e}=p(),a=(n,o)=>e("themeChanged",n,o);return a(B),{colorScheme:t.readonly(de),themeParams:t.readonly(ge),headerColor:t.computed({get(){return fe.value},set(n){Be(n)}}),backgroundColor:t.computed({get(){return be.value},set(n){Ae(n)}}),setHeaderColor:Be,setBackgroundColor:Ae,onThemeChanged:a}}const he=t.ref(Telegram.WebApp.isExpanded),We=t.ref(Telegram.WebApp.viewportHeight),Te=t.ref(Telegram.WebApp.viewportStableHeight);function Ce(){he.value=Telegram.WebApp.isExpanded,We.value=Telegram.WebApp.viewportHeight,Te.value=Telegram.WebApp.viewportStableHeight}function yt(...e){Telegram.WebApp.expand(...e),Ce()}function ye(){const{onEvent:e}=p(),a=(n,o)=>e("viewportChanged",n,o);return a(Ce),{isExpanded:t.readonly(he),viewportHeight:t.readonly(We),viewportStableHeight:t.readonly(Te),expand:yt,onViewportChanged:a}}const Se=t.defineComponent({__name:"ScanQr",props:{text:{type:String}},emits:["result"],setup(e,{emit:a}){const n=e,o=a,{showScanQrPopup:i,closeScanQrPopup:s}=se();return t.onMounted(()=>i({text:n.text},c=>o("result",c))),t.onUnmounted(()=>s()),(c,u)=>null}}),ke=t.defineComponent({__name:"SettingsButton",props:{visible:{type:Boolean,default:!0}},emits:["click"],setup(e,{emit:a}){const n=e,o=a,{showSettingsButton:i,onSettingsButtonClicked:s,hideSettingsButton:c}=me();return t.watch(()=>n.visible,u=>{u?i():c()}),s(()=>o("click")),t.onMounted(()=>n.visible&&i()),t.onUnmounted(()=>c()),(u,d)=>null}}),Me=t.defineComponent({__name:"ShareWidget",props:{url:{type:String,required:!0},comment:{type:String,default:null},size:{type:String,default:null},noLabel:{type:Boolean,default:!1},tag:{type:String,default:"div"}},setup(e){const a=e,n=t.computed(()=>JSON.stringify(a));return(o,i)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.tag),{key:n.value},{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent("script"),{async:"",src:"https://telegram.org/js/telegram-widget.js?22","data-telegram-share-url":e.url,"data-size":e.size,"data-comment":e.comment,"data-text":e.noLabel?"notext":null},null,8,["data-telegram-share-url","data-size","data-comment","data-text"]))]),_:1}))}}),we=t.defineComponent({__name:"PostWidget",props:{url:{type:String,required:!0},width:{type:String,default:null},authorPhoto:{type:Boolean,default:null},color:{type:String,default:null},darkColor:{type:String,default:null},dark:{type:Boolean,default:null},tag:{type:String,default:"div"}},setup(e){const a=e,n=t.computed(()=>JSON.stringify(a));return(o,i)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.tag),{key:n.value},{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent("script"),{async:"",src:"https://telegram.org/js/telegram-widget.js?22","data-telegram-post":e.url,"data-width":e.width,"data-userpic":e.authorPhoto,"data-color":e.color,"data-dark-color":e.darkColor,"data-dark":e.dark},null,8,["data-telegram-post","data-width","data-userpic","data-color","data-dark-color","data-dark"]))]),_:1}))}}),Pe=t.defineComponent({__name:"LoginWidget",props:{botUsername:{type:String,required:!0},redirectUrl:{type:String,default:null},size:{type:String,default:null},cornerRadius:{type:String,default:null},userPhoto:{type:Boolean,default:null},requestWrite:{type:Boolean,default:!1},tag:{type:String,default:"div"}},emits:["auth"],setup(e,{emit:a}){const n=e,o=t.computed(()=>JSON.stringify(n)),i=a;return t.onMounted(()=>{window.onTelegramAuth=s=>i("auth",s)}),(s,c)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.tag),{key:o.value},{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent("script"),{async:"",src:"https://telegram.org/js/telegram-widget.js?22","data-telegram-login":e.botUsername,"data-size":e.size,"data-radius":e.cornerRadius,"data-userpic":e.userPhoto,"data-request-access":e.requestWrite?"write":null,"data-onauth":e.redirectUrl?null:"onTelegramAuth(user)","data-auth-url":e.redirectUrl},null,8,["data-telegram-login","data-size","data-radius","data-userpic","data-request-access","data-onauth","data-auth-url"]))]),_:1}))}}),_e=t.defineComponent({__name:"DiscussionWidget",props:{url:{type:String,required:!0},commentsLimit:{type:Number,default:null},height:{type:String,default:null},color:{type:String,default:null},darkColor:{type:String,default:null},dark:{type:Boolean,default:null},colorful:{type:Boolean,default:null},tag:{type:String,default:"div"}},setup(e){const a=e,n=t.computed(()=>JSON.stringify(a));return(o,i)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.tag),{key:n.value},{default:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent("script"),{async:"",src:"https://telegram.org/js/telegram-widget.js?22","data-telegram-discussion":e.url,"data-comments-limit":e.commentsLimit,"data-height":e.height,"data-color":e.color,"data-dark-color":e.darkColor,"data-dark":e.dark,"data-colorful":e.colorful},null,8,["data-telegram-discussion","data-comments-limit","data-height","data-color","data-dark-color","data-dark","data-colorful"]))]),_:1}))}}),St={install(e){e.component("TgAlert",A),e.component("TgBackButton",h),e.component("TgBiometricManager",W),e.component("TgClosingConfirmation",T),e.component("TgConfirm",C),e.component("TgExpandedViewport",y),e.component("TgMainButton",S),e.component("TgPopup",k),e.component("TgScanQr",Se),e.component("TgSettingsButton",ke),e.component("TgShareWidget",Me),e.component("TgPostWidget",we),e.component("TgLoginWidget",Pe),e.component("TgDiscussionWidget",_e)}};r.Alert=A,r.BackButton=h,r.BiometricManager=W,r.ClosingConfirmation=T,r.Confirm=C,r.DiscussionWidget=_e,r.ExpandedViewport=y,r.LoginWidget=Pe,r.MainButton=S,r.Popup=k,r.PostWidget=we,r.ScanQr=Se,r.SettingsButton=ke,r.ShareWidget=Me,r.default=St,r.useWebApp=p,r.useWebAppBackButton=E,r.useWebAppBiometricManager=L,r.useWebAppClipboard=ve,r.useWebAppClosingConfirmation=v,r.useWebAppCloudStorage=Ze,r.useWebAppHapticFeedback=ot,r.useWebAppMainButton=re,r.useWebAppNavigation=ct,r.useWebAppPopup=f,r.useWebAppQrScanner=se,r.useWebAppRequests=bt,r.useWebAppSendData=Tt,r.useWebAppSettingsButton=me,r.useWebAppTheme=Ct,r.useWebAppViewport=ye,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
