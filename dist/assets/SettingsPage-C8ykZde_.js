import{_ as r,r as c,o as h,c as _,d,w as S,n as m,e as w,t as g,j as E,k,m as f,a as n,h as p,l as I,F as N,q as y,N as b}from"./index-D5IhssbA.js";const v={data(){return{edit:"Редактировать",save:"Сохранить"}},props:{editInfo:{type:Boolean}},methods:{clickEdit(){this.editInfo===!1?(this.$emit("updateParent",!0),this.edit="Редактировать"):(this.$emit("updateParent",!1),this.edit="Сохранить")}}},A={class:"mb-4"};function B(t,e,i,u,s,a){const l=c("el-button");return h(),_("div",A,[d(l,{class:m({editBg:!i.editInfo}),onClick:a.clickEdit},{default:S(()=>[w(g(s.edit),1)]),_:1},8,["class","onClick"])])}const U=r(v,[["render",B]]),D={components:{ButtonEdit:U},data(){return{userFirstName:this.firstName,userLastName:this.lastName,userEmail:this.email,stateBtn:this.editInfo,userId:null,statusEmail:null}},props:{editInfo:{type:Boolean},lastName:{type:String},firstName:{type:String},email:{type:String}},methods:{...E(["updateEmail"]),...k(["getStatus"]),async postEditUserData(){this.$emit("updateParent",this.editInfo),await fetch(`https://musorok.online:8000/update_client_info/${this.userId}`,{method:"POST",headers:{"Content-Type":"application/json",accept:"application/json"},body:JSON.stringify({first_name:this.userFirstName,last_name:this.userLastName,email:this.userEmail})}).then(i=>i.json()).then(i=>{console.log("Имя пользователя успешно обновлено на сервере:",i),this.getStatus()}).catch(i=>{console.error("Ошибка при обновлении имени на сервере:",i)});let e=await(await fetch(`https://musorok.online:8000/client_detail_info/${this.userId}`)).json();this.statusEmail=e.notifications_email,console.log("email",this.statusEmail),this.setEmail(),console.log(e,"запросил")},setEmail(){this.updateEmail(this.statusEmail)}},computed:{...f(["getUserId"]),userTgId(){return this.userId=this.getUserId}},watch:{firstName(t){this.userFirstName=t},lastName(t){this.userLastName=t},email(t){this.userEmail=t}},created(){this.userTgId,this.setEmail}},j={class:"edit__data"},C={class:"data__user"},x=["readonly"],T={class:"data__user"},P=["readonly"],V={class:"data__user"},F=["readonly"];function L(t,e,i,u,s,a){const l=c("ButtonEdit");return h(),_(N,null,[n("div",j,[n("div",C,[p(n("input",{class:m({noEdit:i.editInfo}),readonly:i.editInfo,type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>s.userFirstName=o),onInput:e[1]||(e[1]=(...o)=>t.updateName&&t.updateName(...o))},null,42,x),[[I,s.userFirstName]])]),n("div",T,[p(n("input",{class:m({noEdit:i.editInfo}),readonly:i.editInfo,type:"text","onUpdate:modelValue":e[2]||(e[2]=o=>s.userLastName=o),onInput:e[3]||(e[3]=(...o)=>t.updateLastName&&t.updateLastName(...o))},null,42,P),[[I,s.userLastName]])]),n("div",V,[p(n("input",{class:m({noEdit:i.editInfo}),readonly:i.editInfo,type:"text","onUpdate:modelValue":e[4]||(e[4]=o=>s.userEmail=o),placeholder:"Введите email"},null,10,F),[[I,s.userEmail]])])]),d(l,{onClick:a.postEditUserData,editInfo:i.editInfo,onUpdateParent:e[5]||(e[5]=o=>i.editInfo=o)},null,8,["onClick","editInfo"])],64)}const M=r(D,[["render",L]]),O={data(){return{checkSwitch:!1,userID:this.tgUserId,disabledSwitch:this.getStatusDisabledSwitch,emailUser:"",updateInfo:this.stateEditInfo,notifications_email:null}},props:{tgUserId:{type:Number},userEmail:{type:String},stateEditInfo:{type:Boolean}},computed:{...f(["getNotificationDisabled","getUserId"]),getStatusDisabledSwitch(){return this.getNotificationDisabled}},methods:{...E(["updateEmail"]),...k(["getStatus"]),async getStatusSwitch(){let e=await(await fetch(`https://musorok.online:8000/client_detail_info/${this.userID}`)).json();this.notifications_email=e.notifications_email,this.emailUser=e.email,this.notifications_email===1?this.checkSwitch=!0:this.notifications_email===0&&(this.checkSwitch=!1)},postStateSwitch(){console.log(this.checkSwitch),fetch(`https://musorok.online:8000/update_notifications/${this.userID}`,{method:"POST",headers:{"Content-Type":"application/json",accept:"application/json"},body:JSON.stringify({notifications_email:this.checkSwitch})}).then(t=>{if(!t.ok)throw new Error("Ошибка при выполнении запроса");return t.json()}).then(t=>{this.getStatus(),console.log("Обновил:",t)}).catch(t=>{console.error("Ошибка при обновлении значений переключения:",t),t.response&&t.response.data&&t.response.data.detail&&t.response.data.detail.forEach(e=>{console.error(`Ошибка: ${e.msg}`)})})}},created(){this.getStatusSwitch()}};function G(t,e,i,u,s,a){const l=c("el-switch");return h(),y(l,{onClick:a.postStateSwitch,modelValue:s.checkSwitch,"onUpdate:modelValue":e[0]||(e[0]=o=>s.checkSwitch=o),class:"mt-2","inline-prompt":"","aria-checked":s.checkSwitch,disabled:a.getStatusDisabledSwitch},null,8,["onClick","modelValue","aria-checked","disabled"])}const J=r(O,[["render",G]]),q={data(){return{checkSwitch:!1,userID:this.tgUserId,notifications_tg:null}},props:{tgUserId:{type:Number}},computed:{},methods:{async getStatusSwitch(){let e=await(await fetch(`https://musorok.online:8000/client_detail_info/${this.userID}`)).json();this.notifications_tg=e.notifications_tg,this.notifications_tg===1?this.checkSwitch=!0:this.notifications_tg===0&&(this.checkSwitch=!1)},postStateSwitch(){console.log(this.checkSwitch),fetch(`https://musorok.online:8000/update_notifications/${this.userID}`,{method:"POST",headers:{"Content-Type":"application/json",accept:"application/json"},body:JSON.stringify({notifications_tg:this.checkSwitch})}).then(t=>{if(!t.ok)throw new Error("Ошибка при выполнении запроса");return t.json()}).then(t=>{console.log("Обновил:",t)}).catch(t=>{console.error("Ошибка при обновлении значений переключения:",t),t.response&&t.response.data&&t.response.data.detail&&t.response.data.detail.forEach(e=>{console.error(`Ошибка: ${e.msg}`)})})}},mounted(){this.stateSwitch},created(){this.getStatusSwitch()}};function z(t,e,i,u,s,a){const l=c("el-switch");return h(),y(l,{onClick:a.postStateSwitch,modelValue:s.checkSwitch,"onUpdate:modelValue":e[0]||(e[0]=o=>s.checkSwitch=o),class:"mt-2","inline-prompt":"","aria-checked":s.checkSwitch},null,8,["onClick","modelValue","aria-checked"])}const H=r(q,[["render",z]]),K={components:{SwitchMail:J,SwitchTG:H},data(){return{notifications_tg:"",notifications_email:"",userEmail:this.email,stateEditInfo:this.editInfo}},props:{email:{type:String},editInfo:{type:Boolean}},computed:{...f(["getUserId"]),tgUserId(){return this.getUserId}}},Q={class:"notifications"},R={class:"notifications__block"},W=n("div",{class:"block__text"},[n("p",null,"Уведомления в боте")],-1),X={class:"block__switch"},Y={class:"notifications__block"},Z=n("div",{class:"block__text"},[n("p",null,"Уведомления на email")],-1),tt={class:"block__switch"};function et(t,e,i,u,s,a){const l=c("SwitchTG"),o=c("SwitchMail");return h(),_("div",Q,[n("div",R,[W,n("div",X,[d(l,{notifications_tg:s.notifications_tg,tgUserId:a.tgUserId},null,8,["notifications_tg","tgUserId"])])]),n("div",Y,[Z,n("div",tt,[d(o,{notifications_email:s.notifications_email,tgUserId:a.tgUserId,userEmail:s.userEmail,stateEditInfo:s.stateEditInfo},null,8,["notifications_email","tgUserId","userEmail","stateEditInfo"])])])])}const st=r(K,[["render",et]]),it={data(){return{edit:"Изменить"}}},nt={class:"mb-4 buttonEdit"};function ot(t,e,i,u,s,a){const l=c("el-button");return h(),_("div",nt,[d(l,null,{default:S(()=>[w(g(s.edit),1)]),_:1})])}const at=r(it,[["render",ot],["__scopeId","data-v-4fb1a3ec"]]),lt={components:{ButtonEditAddress:at},data(){return{userAddress:this.fullAddress}},props:{fullAddress:{type:String}},watch:{fullAddress(t){this.userAddress=t}}},ct={class:"edit__address"},dt=n("div",{class:"address__title"},[n("h4",null,"Ваш адрес:")],-1),rt={href:"https://tg.musorok.online/validationAddress//validation.html"};function ht(t,e,i,u,s,a){const l=c("ButtonEditAddress");return h(),_(N,null,[n("div",ct,[dt,n("p",{class:m({noEdit:!t.editAddress})},g(s.userAddress),3)]),n("a",rt,[d(l)])],64)}const ut=r(lt,[["render",ht]]),_t={components:{NavigationMenu:b,EditInfo:M,Notifications:st,ButtonEdit:U,EditAddress:ut},data(){return{editInfo:!0,firstName:null,lastName:null,fullAddress:null,email:null}},computed:{editInfoUpdate(){return this.editInfo},...f(["getUserId"]),userId(){let t=this.getUserId;this.getUserDetailInfoById(t)}},methods:{async getUserDetailInfoById(t){let i=await(await fetch(`https://musorok.online:8000/client_detail_info/${t}`)).json();this.firstName=i.first_name,this.lastName=i.last_name,this.email=i.email,this.fullAddress=i.full_adress,console.log(i)},handleUpdateParent(t){this.editInfo=t}},mounted(){this.userId,this.editInfoUpdate}},mt={class:"settings"},ft=n("div",{class:"settings__title"},[n("h2",null,"Настройки профиля")],-1),pt={class:"settings__content"};function It(t,e,i,u,s,a){const l=c("EditInfo"),o=c("Notifications"),$=c("EditAddress");return h(),_("div",mt,[ft,n("div",pt,[d(l,{editInfo:s.editInfo,firstName:s.firstName,lastName:s.lastName,email:s.email,onUpdateParent:a.handleUpdateParent},null,8,["editInfo","firstName","lastName","email","onUpdateParent"]),d(o,{editInfo:s.editInfo,email:s.email,class:"content__notifications"},null,8,["editInfo","email"]),d($,{fullAddress:s.fullAddress},null,8,["fullAddress"])])])}const St=r(_t,[["render",It]]);export{St as default};
